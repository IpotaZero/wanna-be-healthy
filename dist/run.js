const v="modulepreload",E=function(i,e){return new URL(i,e).href},g={},S=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let b=function(a){return Promise.all(a.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};const o=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),l=n?.nonce||n?.getAttribute("nonce");r=b(t.map(a=>{if(a=E(a,s),a in g)return;g[a]=!0;const c=a.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(!!s)for(let h=o.length-1;h>=0;h--){const p=o[h];if(p.href===a&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":v,c||(d.as="script"),d.crossOrigin="",d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),c)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})}))}function m(o){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=o,window.dispatchEvent(n),!n.defaultPrevented)throw o}return r.then(o=>{for(const n of o||[])n.status==="rejected"&&m(n.reason);return e().catch(m)})};class w{static fadeOut(e,t=200){return e.style.transition=`opacity ${t}ms`,e.style.opacity="0",e.style.pointerEvents="none",this.sleep(t)}static async fadeIn(e,t=200){e.style.transition=`opacity ${t}ms`,e.style.opacity="1",await this.sleep(t),e.style.pointerEvents="all"}static sleep(e){return new Promise(t=>{setTimeout(t,e)})}static ok(){const e=new AbortController;return new Promise(t=>{document.addEventListener("click",()=>{e.abort(),t()},{signal:e.signal}),document.addEventListener("keydown",s=>{["KeyZ","Enter","Space"].includes(s.code)&&(e.abort(),t())},{signal:e.signal})})}static key(){const e=new AbortController;return new Promise(t=>{document.addEventListener("click",()=>{e.abort(),t()},{signal:e.signal}),document.addEventListener("keydown",s=>{e.abort(),t()},{signal:e.signal})})}}class k{static#e;static init(e){this.#e=e}static async goto(e,{showLoading:t=this.#t,hideLoading:s=this.#s,msIn:r=200,msOut:m=200}={}){const o=document.getElementById("container");await w.fadeOut(o,r),await this.#e.end();let n=!1,l=!1;w.sleep(1e3).then(()=>{n||(t(),l=!0)}),this.#e=e(),await this.#e.ready,n=!0,l&&s(),await w.fadeIn(o,m)}static#t(){const e=document.createElement("p");e.textContent="Loading...",e.classList.add("loading"),document.body.appendChild(e)}static#s(){document.querySelectorAll(".loading").forEach(e=>e.remove())}}class L{static#e;static#t;static audio=null;static#s=null;static#i=.3;static path="";static#n=!1;static init(){if(this.#n)throw new Error("すでにinitialized!");this.#n=!0,this.#e=new AudioContext,this.#t=this.#e.createGain(),this.#t.connect(this.#e.destination)}static fetch(e,t=!0){return this.audio?.pause(),this.#s?.disconnect(),this.path=e,new Promise(s=>{this.audio=new Audio(e),this.audio.loop=t,this.#s=this.#e.createMediaElementSource(this.audio),this.#s.connect(this.#t),this.audio.readyState>=2?(s(),this.setVolume(this.#i)):this.audio.oncanplay=()=>{s(),this.setVolume(this.#i)}})}static async play(){await this.#e.resume(),await this.audio?.play()}static pause(){this.audio?.pause()}static async fadeOut(e){await this.fade(0,e),this.pause()}static async fade(e,t){this.#t.gain.cancelScheduledValues(this.#e.currentTime),this.#t.gain.linearRampToValueAtTime(e,this.#e.currentTime+t/1e3),await new Promise(s=>setTimeout(s,t))}static setVolume(e){this.#i=e,this.#t.gain.cancelScheduledValues(0),this.#t.gain.value=this.#i}}class y{static isAvailable=!0;static keyboard={pressed:new Set,longPressed:new Set,pushed:new Set,upped:new Set};static mouse={position:{x:0,y:0},clicked:new Set,upped:new Set,down:new Set,about:new Set};static focusState={isFocused:!0,justFocused:!1,justBlurred:!1};static#e=!1;static init(){if(this.#e)throw new Error("Input is already initialized!");this.#e=!0,document.addEventListener("contextmenu",e=>(e.preventDefault(),e.stopPropagation(),!1)),document.addEventListener("keydown",e=>{if(e.code==="Tab")return e.preventDefault(),e.stopPropagation(),!1}),document.addEventListener("pointerdown",this.#i.bind(this),{passive:!1}),document.addEventListener("pointermove",this.#n.bind(this),{passive:!1}),document.addEventListener("pointerleave",this.#a.bind(this),{passive:!1}),document.addEventListener("pointercancel",this.#a.bind(this),{passive:!1}),document.addEventListener("keydown",this.#t.bind(this)),document.addEventListener("keyup",this.#s.bind(this)),window.addEventListener("blur",this.#o.bind(this)),window.addEventListener("focus",this.#r.bind(this)),document.addEventListener("visibilitychange",this.#c.bind(this))}static update(){this.#e||console.error("Input is not initialized!"),this.keyboard.longPressed.clear(),this.keyboard.pushed.clear(),this.keyboard.upped.clear(),this.mouse.clicked.clear(),this.mouse.upped.clear(),this.focusState.justFocused=!1,this.focusState.justBlurred=!1,this.isAvailable||(this.mouse.down.clear(),this.keyboard.pressed.clear())}static#t(e){this.isAvailable&&(this.keyboard.pressed.has(e.code)||this.keyboard.pushed.add(e.code),this.keyboard.pressed.add(e.code),this.keyboard.longPressed.add(e.code))}static#s(e){this.isAvailable&&(this.keyboard.pressed.delete(e.code),this.keyboard.upped.add(e.code))}static#i(e){this.isAvailable&&(this.mouse.down.add("left"),this.mouse.clicked.add("left"),this.#d())}static#n(e){this.isAvailable}static#a(e){this.isAvailable&&(this.mouse.down.delete("left"),this.mouse.upped.add("left"))}static#d(){this.mouse.about.clear();const{x:e,y:t}=this.mouse.position,s=window.innerWidth,r=window.innerHeight;e<s/3?this.mouse.about.add("left"):e>s*2/3&&this.mouse.about.add("right"),t<r/3?this.mouse.about.add("up"):t>r*2/3&&this.mouse.about.add("down"),e>=s/3&&e<=s*2/3&&t>=r/3&&t<=r*2/3&&this.mouse.about.add("center")}static#o(){console.log("よそ見するにゃ!"),this.focusState.isFocused=!1,this.focusState.justBlurred=!0}static#r(){console.log("こっち見んにゃ!"),this.focusState.isFocused=!0,this.focusState.justFocused=!0}static#c(){document.visibilityState==="visible"?this.#r():this.#o()}}(i=>{i.mouseButtons=["left","middle","right","back","forward"],i.keys=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Escape","Backspace","Tab","Space","ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","MetaLeft","MetaRight","CapsLock","NumLock","ScrollLock","Insert","Delete","Home","End","PageUp","PageDown","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","ContextMenu","Pause","PrintScreen"],i.directions=["left","right","up","down","center"]})(y||(y={}));const{keyboard:P,focusState:F,mouse:D}=y;class f{#e;constructor(e,t=1){this.#e=new Audio(e),this.#e.volume=t}get duration(){return this.#e.duration}play(){this.#e.currentTime=0,this.#e.play()}setVolume(e){this.#e.volume=e}}class T{static click=new f("assets/sounds/クリック.mp3");static voice=new f("assets/sounds/select.wav");static damage=new f("assets/sounds/damage.mp3",.3);static MCR=new f("assets/sounds/MCR.wav",.3);static setVolume(e){Object.values(this).forEach(t=>{t.setVolume(e)})}}class K extends HTMLElement{#e;#t=0;#s;#i;onEnd=()=>{};constructor(e,t){super(),this.hasAttribute("se")?this.#i=new f(this.getAttribute("se")):this.#i=t,this.#s=e??this.innerText,this.innerText="",this.#e=setInterval(this.#n.bind(this),1e3/30)}#n(){this.textContent+=this.#s[this.#t++]??"",this.#t%2===0&&this.#i?.play(),this.#t>=this.#s.length&&(this.onEnd(),clearInterval(this.#e))}}customElements.define("i-typing",K);document.addEventListener("DOMContentLoaded",async()=>{L.init(),y.init();const{ScenePretitle:i}=await S(async()=>{const{ScenePretitle:e}=await import("./assets/ScenePretitle-D0RG9J4q.js").then(t=>t.a);return{ScenePretitle:e}},[],import.meta.url);k.init(new i)});export{w as A,L as B,K as E,y as I,k as S,S as _,T as a,P as k};
//# sourceMappingURL=run.js.map
