const v="modulepreload",E=function(i,t){return new URL(i,t).href},g={},S=function(t,e,s){let a=Promise.resolve();if(e&&e.length>0){let b=function(r){return Promise.all(r.map(l=>Promise.resolve(l).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),d=n?.nonce||n?.getAttribute("nonce");a=b(e.map(r=>{if(r=E(r,s),r in g)return;g[r]=!0;const l=r.endsWith(".css"),f=l?'[rel="stylesheet"]':"";if(!!s)for(let p=o.length-1;p>=0;p--){const y=o[p];if(y.href===r&&(!l||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${f}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":v,l||(c.as="script"),c.crossOrigin="",c.href=r,d&&c.setAttribute("nonce",d),document.head.appendChild(c),l)return new Promise((p,y)=>{c.addEventListener("load",p),c.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${r}`)))})}))}function u(o){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=o,window.dispatchEvent(n),!n.defaultPrevented)throw o}return a.then(o=>{for(const n of o||[])n.status==="rejected"&&u(n.reason);return t().catch(u)})};class w{static fadeOut(t,e=200){return t.style.transition=`opacity ${e}ms`,t.style.opacity="0",t.style.pointerEvents="none",this.sleep(e)}static async fadeIn(t,e=200){t.style.transition=`opacity ${e}ms`,t.style.opacity="1",await this.sleep(e),t.style.pointerEvents="all"}static sleep(t){return new Promise(e=>{setTimeout(e,t)})}static ok(){const t=new AbortController;return new Promise(e=>{document.addEventListener("click",()=>{t.abort(),e()},{signal:t.signal}),document.addEventListener("keydown",s=>{["KeyZ","Enter","Space"].includes(s.code)&&(t.abort(),e())},{signal:t.signal})})}static key(){const t=new AbortController;return new Promise(e=>{document.addEventListener("click",()=>{t.abort(),e()},{signal:t.signal}),document.addEventListener("keydown",s=>{t.abort(),e()},{signal:t.signal})})}}class k{static#t;static init(t){this.#t=t}static async goto(t,{showLoading:e=this.#e,hideLoading:s=this.#s,msIn:a=200,msOut:u=200}={}){const o=document.getElementById("container");await w.fadeOut(o,a),await this.#t.end();let n=!1,d=!1;w.sleep(1e3).then(()=>{n||(e(),d=!0)}),this.#t=t(),await this.#t.ready,n=!0,d&&s(),await w.fadeIn(o,u)}static#e(){const t=document.createElement("p");t.textContent="Loading...",t.classList.add("loading"),document.body.appendChild(t)}static#s(){document.querySelectorAll(".loading").forEach(t=>t.remove())}}class L{static context;static gain;static source=null;static#t=.3;static#e=!1;static init(){if(this.#e)throw new Error("すでにinitialized!");this.#e=!0,this.context=new AudioContext,this.gain=this.context.createGain(),this.gain.connect(this.context.destination)}static async fetch(t,{loopStart:e,loopEnd:s,loop:a,volume:u}={}){this.source?.stop(),this.source?.disconnect(),this.pause(),this.#s(this.#t*(u??1));const n=await(await fetch(t)).arrayBuffer(),d=await this.context.decodeAudioData(n);this.source=this.context.createBufferSource(),this.source.buffer=d,this.source.loop=a??!0,this.source.loopStart=e??0,this.source.loopEnd=s??this.source.buffer.duration,this.source.connect(this.gain),this.source.start()}static async play(){await this.context.resume()}static async pause(){await this.context.suspend()}static async fadeOut(t){await this.fade(0,t),this.pause()}static async fade(t,e){this.gain.gain.cancelScheduledValues(this.context.currentTime),this.gain.gain.linearRampToValueAtTime(t,this.context.currentTime+e/1e3),await new Promise(s=>setTimeout(()=>s(),e))}static#s(t){this.gain.gain.cancelScheduledValues(0),this.gain.gain.value=t}}class m{static isAvailable=!0;static keyboard={pressed:new Set,longPressed:new Set,pushed:new Set,upped:new Set};static mouse={position:{x:0,y:0},clicked:new Set,upped:new Set,down:new Set,about:new Set};static focusState={isFocused:!0,justFocused:!1,justBlurred:!1};static#t=!1;static init(){if(this.#t)throw new Error("Input is already initialized!");this.#t=!0,document.addEventListener("contextmenu",t=>(t.preventDefault(),t.stopPropagation(),!1)),document.addEventListener("keydown",t=>{if(t.code==="Tab")return t.preventDefault(),t.stopPropagation(),!1}),document.addEventListener("pointerdown",this.#i.bind(this),{passive:!1}),document.addEventListener("pointermove",this.#a.bind(this),{passive:!1}),document.addEventListener("pointerleave",this.#n.bind(this),{passive:!1}),document.addEventListener("pointercancel",this.#n.bind(this),{passive:!1}),document.addEventListener("keydown",this.#e.bind(this)),document.addEventListener("keyup",this.#s.bind(this)),window.addEventListener("blur",this.#r.bind(this)),window.addEventListener("focus",this.#c.bind(this)),document.addEventListener("visibilitychange",this.#d.bind(this))}static update(){this.#t||console.error("Input is not initialized!"),this.keyboard.longPressed.clear(),this.keyboard.pushed.clear(),this.keyboard.upped.clear(),this.mouse.clicked.clear(),this.mouse.upped.clear(),this.focusState.justFocused=!1,this.focusState.justBlurred=!1,this.isAvailable||(this.mouse.down.clear(),this.keyboard.pressed.clear())}static#e(t){this.isAvailable&&(t.preventDefault(),this.keyboard.pressed.has(t.code)||this.keyboard.pushed.add(t.code),this.keyboard.pressed.add(t.code),this.keyboard.longPressed.add(t.code))}static#s(t){this.isAvailable&&(t.preventDefault(),this.keyboard.pressed.delete(t.code),this.keyboard.upped.add(t.code))}static#i(t){this.isAvailable&&(this.mouse.down.add("left"),this.mouse.clicked.add("left"),this.#o())}static#a(t){this.isAvailable}static#n(t){this.isAvailable&&(this.mouse.down.delete("left"),this.mouse.upped.add("left"))}static#o(){this.mouse.about.clear();const{x:t,y:e}=this.mouse.position,s=window.innerWidth,a=window.innerHeight;t<s/3?this.mouse.about.add("left"):t>s*2/3&&this.mouse.about.add("right"),e<a/3?this.mouse.about.add("up"):e>a*2/3&&this.mouse.about.add("down"),t>=s/3&&t<=s*2/3&&e>=a/3&&e<=a*2/3&&this.mouse.about.add("center")}static#r(){console.log("よそ見するにゃ!"),this.focusState.isFocused=!1,this.focusState.justBlurred=!0}static#c(){console.log("こっち見んにゃ!"),this.focusState.isFocused=!0,this.focusState.justFocused=!0}static#d(){document.visibilityState==="visible"?this.#c():this.#r()}}(i=>{i.mouseButtons=["left","middle","right","back","forward"],i.keys=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Escape","Backspace","Tab","Space","ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","MetaLeft","MetaRight","CapsLock","NumLock","ScrollLock","Insert","Delete","Home","End","PageUp","PageDown","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","ContextMenu","Pause","PrintScreen"],i.directions=["left","right","up","down","center"]})(m||(m={}));const{keyboard:P,focusState:x,mouse:D}=m;class h{#t;constructor(t,e=1){this.#t=new Audio(t),this.#t.volume=e}get duration(){return this.#t.duration}play(){this.#t.currentTime=0,this.#t.play()}setVolume(t){this.#t.volume=t}}class F{static click=new h("assets/sounds/クリック.mp3");static voice=new h("assets/sounds/select.wav",.5);static damage=new h("assets/sounds/damage.mp3",.3);static MCR=new h("assets/sounds/MCR.wav",.3);static key=new h("assets/sounds/キーボード1.mp3",.8);static setVolume(t){Object.values(this).forEach(e=>{e.setVolume(t)})}}class K extends HTMLElement{#t;#e=0;#s;#i;onEnd=()=>{};#a;end;isEnd=!1;constructor(t,e){super(),this.hasAttribute("se")?this.#i=new h(this.getAttribute("se")):this.#i=e,this.#s=t??this.innerText,this.innerText="",this.reset()}reset(){this.#e=0,this.innerText="",this.#t=setInterval(this.#o.bind(this),1e3/30),this.isEnd=!1,this.end=new Promise(t=>{this.#a=t})}finish(){this.textContent=this.#s,this.#n()}#n(){this.onEnd(),this.isEnd=!0,this.#a(),clearInterval(this.#t)}#o(){this.textContent+=this.#s[this.#e++]??"",this.#e%2===0&&this.#i?.play(),this.#e>=this.#s.length&&this.#n()}}customElements.define("i-typing",K);document.addEventListener("DOMContentLoaded",async()=>{L.init(),m.init();const{ScenePretitle:i}=await S(async()=>{const{ScenePretitle:t}=await import("./assets/ScenePretitle-84PJl96k.js").then(e=>e.b);return{ScenePretitle:t}},[],import.meta.url);k.init(new i)});export{w as A,L as B,K as E,F as S,S as _,k as a};
//# sourceMappingURL=run.js.map
