const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneNight-vIkVHnMp.js","../run.js"])))=>i.map(i=>d[i]);
import{_ as c,S as h}from"../run.js";class l{#e=new AbortController;#t=0;#s=[];direction;constructor(e){this.direction=e,this.update(),window.addEventListener("keydown",this.#r.bind(this),{signal:this.#e.signal})}update(){this.#s=[...document.querySelectorAll("button")].filter(t=>this.#i(t));const e=this.#s.findIndex(t=>t.classList.contains("selected"));this.#t=Math.max(e,0),this.#a(),this.#n()}discard(){this.#e.abort()}#i(e){for(;e;){const t=getComputedStyle(e);if(t.display==="none"||t.visibility==="hidden"||t.opacity==="0")return!1;if(!e.parentElement)return!0;e=e.parentElement}return!0}#a(){this.#s.forEach((e,t)=>{e.onmouseover=()=>{this.#t=t,this.#n()}})}#r(e){const t=this.#s.length,s=this.direction==="horizontal"?"ArrowRight":"ArrowDown",i=this.direction==="horizontal"?"ArrowLeft":"ArrowUp";e.code===s&&(this.#t=(this.#t+1)%t,this.#n()),e.code===i&&(this.#t=(this.#t+t-1)%t,this.#n()),["Enter","Space","KeyZ"].includes(e.code)&&this.#s[this.#t].click(),["Escape","Backspace","KeyX"].includes(e.code)&&this.#s.find(n=>n.hasAttribute("data-back"))?.click()}#n(){this.#s.forEach((e,t)=>{e.classList.toggle("selected",t===this.#t),t===this.#t&&e.focus()})}}class d{#e=[];#t;#s;#i={};constructor(e,t,s){this.#t=e,this.#t.innerHTML=s,this.#s=[...e.querySelectorAll(".page")],this.#a(t),this.#n(),this.#r()}on(e,t){this.#i[e]=t}#a(e){const t=e.split(" ");this.#e.push(...t.slice(0,-1)),this.#e.push(t.at(-1)),this.#o(t.at(-1),!0)}#r(){this.#t.querySelectorAll("[data-link]").forEach(t=>{const s=t.hasAttribute("data-immediately"),i=t.hasAttribute("data-sever"),n=t.getAttribute("data-link");t.addEventListener("click",()=>{i&&(this.#e=[]),this.#e.push(n),this.#o(n,s)})})}#n(){this.#t.querySelectorAll("[data-back]").forEach(t=>{const s=t.hasAttribute("data-immediately"),i=t.getAttribute("data-back"),n=Number.parseInt(i);if(Number.isNaN(n)||n<=0){console.warn("正しくないdata-back！",t);return}t.addEventListener("click",()=>{if(this.#e.length<=n){console.warn("戻る履歴がない",t);return}let r="";for(let o=0;o<n;o++)this.#e.pop(),r=this.#e[this.#e.length-1];this.#o(r,s)})})}async#o(e,t){const s=this.#t.querySelector(e);if(!s)throw new Error(`そんなpageは無い: ${e}`);t||(await new Promise(i=>{this.#t.style.transition="opacity 200ms",this.#t.style.opacity="0",this.#t.style.pointerEvents="none",setTimeout(i,200)}),this.#t.style.opacity="1",this.#t.style.pointerEvents=""),this.#s.forEach(i=>{i.classList.toggle("hidden",i!==s)}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{Object.entries(this.#i).forEach(([i,n])=>{e.match(i)&&n()})})})}}class u{end(){}}class p extends u{ready;#e;#t;constructor(){super(),this.ready=this.#s()}async#s(){const e=document.getElementById("container"),t=await fetch("./pages/title.html").then(s=>s.text());this.#t=new d(e,"#normal",t),this.#t.on(".*",()=>{this.#e.update()}),this.#e=new l("horizontal"),this.#i()}#i(){document.querySelector("#game").onclick=async()=>{const{SceneNight:e}=await c(async()=>{const{SceneNight:t}=await import("./SceneNight-vIkVHnMp.js").then(s=>s.am);return{SceneNight:t}},__vite__mapDeps([0,1]),import.meta.url);h.goto(()=>new e)}}end(){this.#e.discard()}}const y=Object.freeze(Object.defineProperty({__proto__:null,SceneTitle:p},Symbol.toStringTag,{value:"Module"}));export{d as P,u as S,y as a};
//# sourceMappingURL=SceneTitle-g7mK2-Rh.js.map
